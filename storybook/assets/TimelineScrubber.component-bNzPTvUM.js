import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{C as w}from"./CollapsibleTree.component-DSHTWi39.js";import"./Header.component-BGqI9wSV.js";import{u as j,o as v,z as q,C as R,R as N,y as z,A as I}from"./ScenarioChart.container.v2-BI2yzkxS.js";import{s as _,a as B}from"./budget.data-CpXsGSqR.js";import{a as E,u as P}from"./ScenarioGraph.component-DA7gkCLf.js";import{r as c}from"./index-PahMPgEy.js";import{t as b}from"./colors-Cuw9ST8W.js";import{D as h}from"./Fire.icon-Di-S4vvp.js";import{P as k,a as f,b as y}from"./react-resizable-panels.browser.esm-zIh8wNIw.js";const V={graph:E,plot:_,budgets:B};function T({budget:e}){return t.jsxs("div",{className:"flex h-full w-full select-none flex-col border-l border-slate-800 bg-slate-900 text-slate-300",children:[t.jsx("div",{className:"bg-slate-800 px-4 py-1 text-sm font-medium text-slate-500",children:"Budget Details"}),e?t.jsxs("div",{className:"flex-grow overflow-y-auto pb-4",children:[t.jsx("div",{className:"px-4 pb-2 pt-4 text-lg font-medium",children:e?e.name:"No budget selected"}),t.jsx(w,{tree:e.categories,parentContainerClasses:"cursor-pointer hover:bg-slate-800 px-4",childContainerClasses:"cursor-default px-4",renderCollapsibleItemContent:a=>t.jsxs("div",{className:"flex flex-row py-2",children:[t.jsx("div",{className:"grow",children:a.name}),t.jsx("div",{className:"text-gray-500",children:a.value})]}),renderLeafItemContent:a=>t.jsxs("div",{className:"flex flex-row py-2",children:[t.jsx("div",{className:"grow",children:a.name}),t.jsx("div",{children:Y(a.value)})]})},e.name)]}):t.jsx("div",{className:"px-4 pb-2 pt-4 text-lg font-medium text-slate-600",children:"No budget selected"})]})}function Y(e){return e>=0?e.toFixed(0).toString():`(${Math.abs(e).toFixed(0)})`}T.__docgenInfo={description:"",methods:[],displayName:"ScenarioBudget",props:{budget:{required:!0,tsType:{name:"union",raw:"BudgetCategories | null",elements:[{name:"BudgetCategories"},{name:"null"}]},description:""}}};function $(){const e=P(i=>i.selectedBudgetId),a=e?V.budgets[e]:null;return t.jsx(T,{budget:a})}$.__docgenInfo={description:"",methods:[],displayName:"ScenarioBudget"};function S({width:e,height:a,data:i,period:s,interval:n="month",cumulative:o=!1}){const r=c.useRef(null);return c.useEffect(()=>{var u;const l=j([v([0]),q(i,R({y:"sum"},{x:"date",y:"amount",fill:"name",interval:n,cumulative:o}))]).plot({width:e,height:a,marginLeft:50,y:{grid:!0},x:{domain:[new Date(s.startDate),new Date(s.endDate)]}});return(u=r.current)==null||u.append(l),()=>l.remove()},[o,i,a,n,s.endDate,s.startDate,e]),t.jsx("div",{ref:r,className:"h-full w-full"})}S.__docgenInfo={description:"",methods:[],displayName:"ScenarioChartV1",props:{width:{required:!0,tsType:{name:"number"},description:""},height:{required:!0,tsType:{name:"number"},description:""},data:{required:!0,tsType:{name:"Plot.Data"},description:""},period:{required:!0,tsType:{name:"Period"},description:""},interval:{required:!1,tsType:{name:"Plot.RangeInterval"},description:"",defaultValue:{value:"'month'",computed:!1}},cumulative:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};function A({scenarioEvents:e,interval:a,cumulative:i}){const{period:s,budgetEvents:n}=e,o=n.map(r=>r.events.map(l=>({date:new Date(l.date),amount:l.value,name:r.budget.name}))).flat();return t.jsx(N,{children:({width:r,height:l})=>t.jsx(S,{width:r,height:l,data:o,period:s,cumulative:i,interval:a})})}A.__docgenInfo={description:"",methods:[],displayName:"ScenarioChartV1",props:{scenarioEvents:{required:!0,tsType:{name:"ScenarioEvents"},description:""},interval:{required:!1,tsType:{name:"Plot.RangeInterval"},description:""},cumulative:{required:!1,tsType:{name:"boolean"},description:""}}};function C({width:e,height:a,data:i}){const s=c.useRef(null);return c.useEffect(()=>{var o;const n=j([v([0]),z(i,{x:r=>new Date(r.date),y:"amount",fill:b.amber[400],opacity:.5}),I(i,{x:r=>new Date(r.date),y:"amount",stroke:b.amber[400]})]).plot({width:e,height:a,marginLeft:0,marginRight:0,marginTop:16,y:{axis:null}});return(o=s.current)==null||o.append(n),()=>n.remove()},[i,a,e]),t.jsx("div",{ref:s,className:"h-full w-full"})}C.__docgenInfo={description:"",methods:[],displayName:"TimelineChart",props:{width:{required:!0,tsType:{name:"number"},description:""},height:{required:!0,tsType:{name:"number"},description:""},data:{required:!1,tsType:{name:"Plot.Data"},description:""}}};function L({leftPanelRef:e,rightPanelRef:a,initialSelection:i,onUpdateSelection:s}){const[n,o]=c.useState(i[0]),[r,l]=c.useState(i[1]),u=c.useCallback(d=>{o(d),s&&s([d,r])},[s,r]),m=c.useCallback(d=>{l(100-d),s&&s([n,100-d])},[s,n]),p=c.useCallback(()=>{var x,g;r-n!==100&&((x=e.current)==null||x.resize(0),(g=a.current)==null||g.resize(0),o(0),l(100),s&&s([0,100]))},[n,r,e,a,s]);return{start:n,end:r,updateStart:u,updateEnd:m,maximize:p}}function D({initialSelection:e=[0,100],onUpdateSelection:a}){const[i,s]=e,n=c.useRef(null),o=c.useRef(null),{start:r,end:l,updateStart:u,updateEnd:m,maximize:p}=L({leftPanelRef:n,rightPanelRef:o,initialSelection:e,onUpdateSelection:a}),d=l-r===999;return t.jsxs(k,{direction:"horizontal",onDoubleClick:p,children:[t.jsx(f,{className:"bg-gradient-to-tr from-slate-600/5 to-slate-600/20 backdrop-blur-[1px]",ref:n,defaultSize:i,onResize:u}),t.jsx(y,{className:"flex w-[5px] flex-col items-center justify-center bg-slate-700",children:t.jsx(h,{className:"text-slate-950",size:16})}),t.jsx(f,{className:`border-b border-t border-slate-700 ${d&&"cursor-grab"}`}),t.jsx(y,{className:"flex w-[5px] flex-col items-center justify-center bg-slate-700",children:t.jsx(h,{className:"text-slate-950",size:16})}),t.jsx(f,{className:"bg-gradient-to-tr from-slate-600/5 to-slate-600/20 backdrop-blur-[1px]",ref:o,defaultSize:100-s,onResize:m})]})}D.__docgenInfo={description:"",methods:[],displayName:"TimelineSelector",props:{initialSelection:{required:!1,tsType:{name:"Selection"},description:"",defaultValue:{value:"[0, 100]",computed:!1}},onUpdateSelection:{required:!1,tsType:{name:"signature",type:"function",raw:"(selection: Selection) => void",signature:{arguments:[{type:{name:"Selection"},name:"selection"}],return:{name:"void"}}},description:""}}};function F({data:e,initialSelection:a,onUpdateSelection:i}){const s=e&&Array.from(e).length!==0;return t.jsxs("div",{className:"relative flex h-40 w-full items-center justify-center border-y border-slate-800 bg-slate-900",children:[t.jsx(N,{children:({width:n,height:o})=>t.jsx(C,{width:n,height:o,data:e})}),s&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 top-0 flex",children:t.jsx(D,{initialSelection:a,onUpdateSelection:i})})]})}F.__docgenInfo={description:"",methods:[],displayName:"TimelineScrubber",props:{data:{required:!1,tsType:{name:"Plot.Data"},description:""},initialSelection:{required:!1,tsType:{name:"Selection"},description:""},onUpdateSelection:{required:!1,tsType:{name:"signature",type:"function",raw:"(selection: Selection) => void",signature:{arguments:[{type:{name:"Selection"},name:"selection"}],return:{name:"void"}}},description:""}}};export{T as S,F as T,A as a,V as b,$ as c};
